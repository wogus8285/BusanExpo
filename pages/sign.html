<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="../favicon.ico" type="image/x-icon" />
    <title>부산 세계 박람회</title>
    <!-- 초기화 -->
    <link rel="stylesheet" href="../css/reset.css" />

    <!-- css 남꺼 -->
    <!-- xeicon -->
    <link
      rel="stylesheet"
      href="//cdn.jsdelivr.net/npm/xeicon@2.3.3/xeicon.min.css"
    />
    <!-- slick slider-->
    <link
      rel="stylesheet"
      href="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css"
    />
    <link
      rel="stylesheet"
      href="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick-theme.css"
    />
    <!-- 풀페이지 2.97 -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/fullPage.js/2.9.7/jquery.fullpage.css"
    />
    <!-- 스와이퍼 -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
    />

    <!-- css 내꺼 -->
    <link rel="stylesheet" href="../css/common.css" />
    <link rel="stylesheet" href="../css/header.css" />
    <link rel="stylesheet" href="../css/footer.css" />
    <link rel="stylesheet" href="../css/sign.css" />

    <!-- 제이쿼리 -->
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <!-- 슬릭 -->
    <script
      type="text/javascript"
      src="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"
    ></script>
    <!-- 스크롤리빌 -->
    <script src="https://unpkg.com/scrollreveal"></script>
    <!-- 풀페이지 2.97 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullPage.js/2.9.7/jquery.fullpage.js"></script>
    <!-- 스와이퍼 -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <!-- paper.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/paper.js/0.12.15/paper-full.min.js"></script>
  </head>
  <body>
    <div class="wrap">
      <div class="header_container">
        <!-- ../inc/header.html load -->
      </div>

      <div class="body">
        <div class="banner">
          <div class="logo">
            <img src="../images/sign/signature_logo.png" alt="로고" />
          </div>
          <div class="textbox">
            <h3>2030 부산세계박람회<br />유치를 위한 범국민 서명운동</h3>
            <h6>
              부산이 월드엑스포를 통해 세계와 만납니다. 세계가 부산을 만나
              새로운 미래를 열어갑니다.
            </h6>
          </div>
        </div>

        <div class="pallete work">
          <div class="title">
            <div class="p2">유치를 위한 온라인 서명운동을 진행합니다.</div>
            <h6>
              유치를 위한 여러분의 <span>지지와 응원의 마음을</span><br />
              서명으로 새겨주세요.
            </h6>
          </div>
          <p>From : <span>OOO</span></p>
          <canvas class="canvas work" width="2344" height="800"></canvas>

          <div class="pallete modal">
            <div class="title">
              <div class="p2">유치를 위한 온라인 서명운동을 진행합니다.</div>
              <h6>
                유치를 위한 여러분의 <span>지지와 응원의 마음을</span><br />
                서명으로 새겨주세요.
              </h6>
            </div>
            <p>From : <span>OOO</span></p>
            <canvas class="canvas modal" width="1172" height="400"></canvas>
          </div>
        </div>

        <div class="put">
          <div class="container">
            <h6>온라인 서명하기</h6>
            <form class="sign_form">
              <input type="text" placeholder="이름을 입력해 주세요." />
            </form>
            <div class="btns">
              <div class="btn goSign">
                <p>서명하러 가기</p>
              </div>
              <div class="btn finSign">
                <p>서명 완료</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="dimm"></div>

      <div class="footer_wrap">
        <!-- footer inc load -->
      </div>
    </div>

    <script>
      // ## 로드
      $('.header_container').load('../inc/header.html')
      $('.footer_wrap').load('../inc/footer.html')
    </script>

    <script>
      // ## 버튼
      // 사인 버튼 클릭
      $('.btn.goSign').click(function () {
        // 딤넣기
        let name = $('.sign_form input').val()
        $('.pallete.work p span').text(name)
        $('.dimm').addClass('show')
        $('.finSign').addClass('show')
        $(this).addClass('hide')
        $('.pallete.modal').addClass('show')
        $('.header_container').addClass('dimmShow')
        $('.pallete').css('z-index', '99999')
      })

      // 완료 버튼 클릭
      $('.btn.finSign').click(function () {
        // 딤빼기
        console.log('dd')
        $('.dimm').removeClass('show')
        $('.finSign').removeClass('show')
        $('.btn.goSign').removeClass('hide')
        $('.pallete.modal').removeClass('show')
        $('.header_container').removeClass('dimmShow')
        $('.pallete').css('z-index', '999')
      })

      // 버튼 엔터키 추가
      $('.sign_form input').keypress(function (event) {
        if (event.keyCode === 13) {
          //   event.preventDefault()
          event.preventDefault()
          $('.btn.goSign').click()
          addName()
        }
      })

      // ## 팔레트
      // chat gpt
      let canvas = document.querySelector('.pallete.modal canvas')
      let ctx = canvas.getContext('2d')
      let isDrawing = false

      canvas.addEventListener('mousedown', (e) => {
        isDrawing = true
        ctx.beginPath()
        ctx.moveTo(e.offsetX, e.offsetY)
      })

      canvas.addEventListener('mousemove', (e) => {
        if (isDrawing) {
          ctx.lineTo(e.offsetX, e.offsetY)
          ctx.stroke()
        }
      })

      canvas.addEventListener('mouseup', () => {
        isDrawing = false
      })

      $('.btn.finSign').click(function () {
        // Canvas에서 이미지 데이터 생성
        let dataURL = canvas.toDataURL()

        // work 캔버스 가져오기
        let workCanvas = document.querySelector('.pallete.work canvas')
        let workCtx = workCanvas.getContext('2d')

        // work 캔버스를 지우고 새 그림 그리기
        workCtx.clearRect(0, 0, workCanvas.width, workCanvas.height)

        // 새로운 이미지 요소 생성
        let img = new Image()
        img.onload = function () {
          // work 캔버스에 그림 표시
          workCtx.drawImage(img, 0, 0, workCanvas.width, workCanvas.height)
        }
        img.src = dataURL

        // 서명이 완료되면 Canvas 초기화
        ctx.clearRect(0, 0, canvas.width, canvas.height)

        addName()
      })

      // 서명하면 글자 초기화
      function addName() {
        let name = $('.sign_form input').val()
        if (name !== '') {
          $('.pallete.work p span').text(name)
          $('.sign_form input')
            .val('')
            .attr('placeholder', '이름을 입력해 주세요.')
          $('.btn.goSign').trigger('blur')
        }
      }
    </script>
  </body>
</html>
